# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

morphlines : [
  {
    id : trans_log
    importCommands : ["org.kitesdk.**"]

    commands : [    
     {
        readLine {
          charset: UTF-8
        }
      }
    
      {
        split {
          inputField: message
          outputFields: [trans_date,trans_code,trans_channel_id,trans_start_datetime,trans_end_datetime,trans_cust_time,trans_org_id,trans_clerk,trans_return_code,trans_err_msg,trans_tuexdo_name]
          separator: "|"
          isRegex: false
          addEmptyStrings: false
          trim: true
          limit: 11
        }
      }
      
      {   
       toAvro {
        schemaString : """
            {
            "type" : "record",
            "name" : "TransLog",
            "fields" : [ 
                {
                "name" : "trans_date",
                "type" : "string"
                }, 
                {
                "name" : "trans_code",
                "type" : ["string","null"]
                }, 
                {
                "name" : "trans_channel_id",
                "type" : ["string","null"]
                },
                {
                "name" : "trans_start_datetime",
                "type" : ["string"]
                },
		 {
                "name" : "trans_end_datetime",
                "type" : ["string"]
                },
		 {
                "name" : "trans_cust_time",
                "type" : ["double"]
                }, {
                "name" : "trans_org_id",
                "type" : ["string","null"]
                }, {
                "name" : "trans_clerk",
                "type" : ["string","null"]
                }, {
                "name" : "trans_return_code",
                "type" : ["string","null"]
                }, {
                "name" : "trans_err_msg",
                "type" : ["string","null"]
                }, {
                "name" : "trans_tuexdo_name",
                "type" : ["string","null"]
                }
            ]
            }
          """     
          }
        }      



    ]
  }
]
